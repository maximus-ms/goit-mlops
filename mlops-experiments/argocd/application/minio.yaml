apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
    name: minio
    namespace: infra-tools
spec:
    destination:
        namespace: application
        server: https://kubernetes.default.svc
    project: default
    source:
        repoURL: https://charts.bitnami.com/bitnami
        chart: minio
        targetRevision: 13.7.2
        helm:
            valuesObject:
                image:
                    registry: docker.io
                    repository: bitnamilegacy/minio
                    tag: 2023.12.23-debian-11-r0
                    pullPolicy: IfNotPresent
                mode: standalone

                auth:
                    rootUser: minio
                    rootPassword: minio123
                defaultBuckets: "mlflow-artifacts"
                service:
                    type: ClusterIP
                persistence:
                    enabled: false
    syncPolicy:
        automated:
            prune: true
            selfHeal: true
        syncOptions:
            - CreateNamespace=true
            - ServerSideApply=true
            - SkipDryRunOnMissingResource=true
